<!DOCTYPE html>
<html lang="ja">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Pigeon Framework</title>
        <link rel="shortcut icon" href="img/favicon.png">
        <link rel="stylesheet" href="css/font-awesome.min.css">
        <link rel="stylesheet" href="css/bootstrap.css">
        <link rel="stylesheet" href="css/style.css">
        <!-- google fonts -->
        <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet">
    </head>

<body>
    <div class="page-wrapper">
        <!-- header mobile-->
        <header class="header-mobile d-block d-lg-none">
            <div class="header-mobile__bar">
                <div class="container-fluid">
                    <div class="header-mobile-inner">
                        <a class="logo" href="index.html">Pigeon Framework</a>
                        <div class="header-hamburger"><a class="hamburger-menu hamburger-menu--normal" id="hamburger-btn"><span></span><span></span><span></span></a></div>
                    </div>
                </div>
            </div>
            <div class="nav-dropdown-menu" id="dropdown-menu">
              <nav>
                <ul>
                    <li class="dropdown-menu__item"><a class="dropdown-menu__link" href="index.html">TOP</a></li>
                    <li class="dropdown-menu__item"><a class="dropdown-menu__link" href="function.html">機能紹介</a></li>
                    <li class="dropdown-menu__item"><a class="dropdown-menu__link" href="project.html">事例</a></li>
                    <li class="dropdown-menu__item"><a class="dropdown-menu__link" href="plan.html">プラン</a></li>
                    <li class="dropdown-menu__item"><a class="dropdown-menu__link" href="support.html">サポート</a></li>
                </ul>
                <ul class="menu-list">
                    <li><a href="faq.html">FAQ</a></li>
                    <li><a href="news.html">アップデート＆お知らせ</a></li>
                    <li><a href="terms.html">利用規約</a></li>
                    <li><a href="privacy.html">プライバシーポリシー</a></li>
                </ul>
              </nav>
            </div>
            <div class="dropdown-overlay" id="dropdown-overlay"></div>
        </header>
        <!-- end header mobile-->

        <!-- menu sidebar toggle-->
        <aside class="menu-sidebar-toggle">
            <!-- <div class="menu-sidebar-left d-none d-lg-block"></div> -->

            <div class="hidden-xs hidden-sm">
                <div class="primary-nav">
                    <button href=# type="button" class="hamburger open-panel nav-toggle animated fadeInLeft is-closed" data-toggle="offcanvas">
                    <span class="hamb-top"></span>
                    <span class="hamb-middle"></span>
                    <span class="hamb-bottom"></span>
                    </button>
                  <!-- <button href="#" class="hamburger open-panel nav-toggle"> <span class="screen-reader-text">Menu</span> <a class="hamburger-menu hamburger-menu--normal"><span></span><span></span><span></span></a> </button> -->
                  <nav role="navigation" class="menu">
                    <div class="overflow-container">
                      <ul class="sidebar-nav">
                           <li class="sidebar-brand">
                              <a class="logo" href="index.html">Pigeon Framework</a>
                           </li>
                           <li>
                              <a href="index.html">TOP</a>
                           </li>
                           <li>
                              <a href="function.html">機能紹介</a>
                           </li>
                           <li>
                              <a href="project.html">事例</a>
                           </li>
                           <li>
                              <a href="plan.html">プラン</a>
                           </li>
                           <li>
                              <a href="support.html">サポート</a>
                           </li>
                        </ul>
                    </div>
                  </nav>
                </div> <!-- primary-nav -->
                 <div class="new-wrapper">
                    <div id="toc">
                    </div><!--/.well -->
                    <!-- <div class="sidebar"></div>
                    <div class="menu-sidebar-right wrap-toc">
                    </div> -->
                 </div> 
            </div>
            
            <!-- mobile menu toggle  -->
            <div class="hidden-lg hidden-md">
                <div role="main">
                    <div class="btn-list">
                        <button type="button" class="btn-icon slide-menu-control btn-open" data-target="menu-left" data-action="open"><img src="img/btn_list2x.png"></button>
                    </div>
                </div>
                <nav class="slide-menu" id="menu-left">
                  <div class="controls">
                    <button type="button" class="btn-icon slide-menu-control" data-action="close"><img src="img/btn_list@2x.png"></button>
                  </div>
                  <div class="sidebar"></div>
                    <div class="menu-sidebar-right wrap-toc">
                    </div>
                </nav>
            </div>
        </aside>
        <!-- end menu sidebar toggle-->

        <!-- page content-->
        <div class="page-content">
            <div class="container-fluid">
                <div class="inner-sect__p30">
                    <div class="row">
                        <div class="col-xs-12">
                            <h2 class="text-center">ドキュメント</h2>
                            <div class="divider"></div>
                            <div class="main">
                                <h2 class="m-b-30">インストール方法</h2>
                                <div class="content-items">
                                    <h3 id="環境を確認する">環境を確認する</h3>
                                    <p>
                                        Linux(CentOS,Ubuntu,Amazon Linux)
                                    </p>
                                    <p>
                                        PHP5.6以上
                                    </p>
                                    <p>
                                        MySQL5.6以上
                                    </p>
                                    <p>
                                        apache2.X
                                    </p>
                                    <p>
                                        上記がインストールされていることを確認してください。
                                    </p>
                                </div>
                                <div class="content-items">
                                    <h4 id="オプション環境">オプション環境</h4>
                                    <p>
                                        imagemagick (convertコマンドが使える場合、画像の自動リサイズが可能です。）
                                    </p>
                                    <p>
                                        phpにて、下記関数が使える場合、スマートフォンからのアップロードで画像が回転している場合自動補正します。
                                    </p>
                                    <p>
                                        ・exif_read_data()
                                    </p>
                                    <p>
                                        ・ImageCreateFromJPEG()
                                    </p>
                                </div>

                                <div class="content-items">
                                    <h3 id="基本構成">基本構成</h3>

                                    <p>
                                        DocumentRootに管理画面を配置し、
                                    </p>
                                    <p>
                                        {DocumentRoot}/api
                                    </p>
                                    <p>
                                        にAPIファイルを配置します。
                                    </p>
                                    <p>
                                        <strong>※DocumentRootの中は何も配置しないでください。すべて削除・上書きされます。</strong>
                                    </p>
                                </div>

                                <div class="content-items">

                                    <h3 id="本体をインストールする">本体をインストールする</h3>
                                    <pre class="prettyprint blackbgclr-code">cd ~/ wget https://pigeon-cms.loftal.jp/pigeon_installer && php pigeon_installer</pre>

                                    <p>
                                        ドキュメントルート、ドキュメントルートに外部からアクセスするためのURL、ライセンスキーが聞かれるので入力してください。
                                    </p>
                                    <p>
                                        DB設定に応じて適切なデータベースやテーブルが作成されますので、現時点でアクセス可能なMySQLのアカウント情報を入力してください。
                                    </p>
                                    <p>
                                        例えば、下記のような入力となります。
                                    </p>
                                    <p class="txtclr-red">
                                        ※既存のテーブルに変更は行いませんが、管理者のテーブル(Admin table)及び画像保存用テーブル(image_blob)は新たに作成するため、存在しないテーブル名を指定してください。
                                    </p>
                                    <p>
                                        (画像保存用テーブルのテーブル名変更はできません。）
                                    </p>
                                    <p>
                                        ライセンスはトライアルの場合、”trial”と入力してください。（１ヶ月間のみ有効で、１度だけ有効です。）
                                    </p>
                                    <p>
                                        トライアル用のライセンスキーはこちらから発行可能です。
                                    </p>

                                    <pre class="prettyprint blackbgclr-code"><span>Please input DocumentRoot. (default. /var/www/html):/var/www/html</span><br><span>Please input URL to access DocumentRoot. (ex. http://example.com):http://example.com</span><br><span>Please input LICENSE KEY :test_key</span><br><span>Is production mode? (yes|no):no</span><br><span>Please input DATABASE hostname:localhost</span><br><span>Please input DATABASE user:root</span><br><span>Please input DATABASE password:password</span><br><span>Please input DATABASE name:test_db</span><br><span>Please input Admin table(default admin):admin</span></pre>
                                    <p>
                                        以下、DocumentRoot として /var/www/html/
                                    </p>
                                    <p>
                                        URL: <a href="http://example.com">http://example.com</a>
                                    </p>
                                    <p>
                                        にインストールしたと仮定して説明します。
                                    </p>

                                </div>
                                <div class="content-items">
                                    <span id="composer-にて関連モジュールをインストールする" class="heading-txt">composer にて関連モジュールをインストールする</span>

                                    <p>
                                        もしcomposerにパスが通っていない場合、(composer.pharなどを直接使っている場合）下記のパスでcomposer install (php composer.phar install 等）を行ってください。
                                    </p>

                                    <pre class="prettyprint blackbgclr-code"><span class="code__cc4 p-r-10">cd</span><span>{DocumentRoot}/Pigeon</span><br><span>composer install</span></pre>

                                    <p>
                                        データベースやライセンスキーの設定を書き換えたい場合は、こちらを参考にしてください。
                                    </p>
                                    <span class="heading-txt">/var/www/html/config.php　の下記のDBの設定を書き換えてください。</span>

                                    <pre class="prettyprint blackbgclr-code"><span>define(<span class="code__cc2">"DB_HOST"</span>, <span class="code__cc2">' '</span>);</span><br><span>define(<span class="code__cc2">"DB_USER"</span>, <span class="code__cc2">' '</span>);</span><br><span>define(<span class="code__cc2">"DB_PW"</span>, <span class="code__cc2">' '</span>);</span><br><span>define(<span class="code__cc2">"DB_NAME"</span>, <span class="code__cc2">' '</span>);</span></pre>

                                </div>

                                <div class="content-items">
                                    <span id="apache等のウェブサーバーの設定" class="heading-txt">apache等のウェブサーバーの設定</span>

                                    <p>
                                        上記で入力したhost名で、入力したdocumentRootを見るようにVirtualHost等の設定を行ってください。また、mod_rewriteを有効にしてください。
                                    </p>
                                    <p>
                                        設定完了後、web serverを再起動してください。
                                    </p>
                                </div>
                                <div class="content-items">
                                    <h3 id="管理画面にアクセスする">管理画面にアクセスする</h3>


                                    <p>
                                        管理画面URL（<a href="http://example.com/adminの場合は、">http://example.com</a>/{管理者テーブル名}/login ）にアクセスします。
                                    </p>
                                    <p>
                                        {prefix}admin が管理者テーブルとなります。
                                    </p>
                                    <p>
                                        （prefixがpigeon_の場合,管理者テーブルはpigeon_adminとなります。）
                                    </p>
                                    <p>
                                        管理者テーブル名がpigeon_adminの場合、ログイン画面は
                                    </p>
                                    <p>
                                        <a href="http://example.com/adminの場合は、">http://example.com/</a>pigeon_admin/loginとなります。
                                    </p>
                                    <p>
                                        ログイン画面が開き、ID,パスワードを要求されます。
                                    </p>
                                    <p>
                                        admin / admin
                                    </p>
                                    <p>
                                        を入力してください。
                                    </p>
                                </div>
                                <div class="divider"></div>
                                    <h2 id="メニューの設定">メニューの設定</h2>

                                <div class="content-items m-t-30">
                                    <h3 id="管理するテーブルを設定する">管理するテーブルを設定する</h3>


                                    <p>
                                        /var/www/html/cms_assets/menuconfig.yml
                                    </p>
                                    <p>
                                        ファイルを修正します。
                                    </p>
                                    <p>
                                        menusの中に、管理者テーブルのテーブル名をキーとした配列を作成します。
                                    </p>

                                    <pre class="prettyprint blackbgclr-code"><span>admin:</span><br><span class="p-l-10">label:</span> <span class="code__cc2">"管理者"</span><br><span class="p-l-10">menus:</span><br><span class="p-l-30">- table:</span> <span class="code__cc2">contents</span><br><span class="p-l-50">label:</span> <span class="code__cc2">"コンテンツ"</span><br><span class="p-l-50">fields:</span><br><span class="p-l-70">- field: </span> <span class="code__cc2">title:</span><br><span class="p-l-90">label: </span> <span class="code__cc2">"文字列"</span><br><span class="p-l-90">type:</span> <span class="code__cc2">text</span><br><span class="p-l-90">default: </span> <span class="code__cc2">デフォルト値</span><br><span class="p-l-70">- field: </span> <span class="code__cc2">textarea</span><br><span class="p-l-90">label: </span> <span class="code__cc2">"テキストエリア"</span><br><span class="p-l-90">type:</span> <span class="code__cc2">textarea</span><br><span class="p-l-70">- field: </span> <span class="code__cc2">rich_body</span></pre>

                                <div class="content-items">
                                    <h4 id="基本のhash定義">基本のhash定義</h4>


                                    <p>
                                        rootのkeyは、ユーザーのテーブルとなります。上の例ではadminテーブルのユーザーがログインした時という指定になっています。
                                    </p>

                                    <table class="table table-bordered">
                                        <tr>
                                            <td>
                                            </td>
                                            <td><strong>説明</strong>
                                            </td>
                                            <td><strong>Default</strong>
                                            </td>
                                            <td><strong>必須</strong>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>title
                                            </td>
                                            <td>管理画面ログイン後の左上に表示する文字列
                                            </td>
                                            <td>管理システム
                                            </td>
                                            <td>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>label
                                            </td>
                                            <td>ユーザー組織名
                                            </td>
                                            <td>
                                            </td>
                                            <td>o
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>disable-setting
                                            </td>
                                            <td>右上のドロップダウンメニューで、自分自身の設定を非表示にするかどうか
                                            </td>
                                            <td>false
                                            </td>
                                            <td>
                                            </td>
                                        </tr>
                                    </table>
                                </div>
                                <div class="content-items">
                                    <h4 id="テーブル名のリストの中のhash定義">テーブル名のリストの中のhash定義</h4>


                                    <p>
                                        menusの直下に下の表のhashのlistを作成します。
                                    </p>
                                    <p>
                                        hashは以下の定義が可能です。
                                    </p>
                                    <p>
                                        全て必須ではありません。
                                    </p>

                                    <table class="table table-bordered">
                                        <tr>
                                            <td>
                                            </td>
                                            <td><strong>説明</strong>
                                            </td>
                                            <td><strong>Default</strong>
                                            </td>
                                            <td><strong>必須</strong>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>table
                                            </td>
                                            <td>テーブル名
                                            </td>
                                            <td>
                                            </td>
                                            <td>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>fields
                                            </td>
                                            <td>テーブルで編集・表示するフィールドを管理します。特に記載がない場合は、データベースのテーブル定義から自動的に作成します。詳細は下部の「fieldsのhashの定義」を確認してください。
                                            </td>
                                            <td>テーブル定義から
                                            </td>
                                            <td>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>paren-id-field
                                            </td>
                                            <td>child-table 内のテーブルの場合必須。
                                                <p>
                                                    親のテーブルのIDを表すfield名を指定
                                                <p>
                                                    例（parent_id)
                                            </td>
                                            <td>
                                            </td>
                                            <td>△
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>label
                                            </td>
                                            <td>メニューに表示されるラベル
                                            </td>
                                            <td>
                                            </td>
                                            <td>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>icon
                                            </td>
                                            <td>メニューに表示されるアイコン（font-awesomeのクラス名）
                                            </td>
                                            <td>th-list
                                            </td>
                                            <td>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>child-table
                                            </td>
                                            <td>１：多のテーブルがある場合に定義する。例えば、ユーザー１人に対して持っているアイテムが複数ある場合等。
                                                <p>
                                                    値として定義するhashはtableやfieldsなど、テーブル名のリストのハッシュと同じですが、child-tableの下に更にchild-tableを定義することはできません。
                                            </td>
                                            <td>
                                            </td>
                                            <td>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>parent-id-field
                                            </td>
                                            <td>child-table の中にあるhashでのみ適用可能。親のIDのフィールドをセットします。
                                            </td>
                                            <td>{親テーブル名}_id
                                            </td>
                                            <td>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>url
                                            </td>
                                            <td>ページにリンクしたい場合、リンク先のURLを設定します。
                                            </td>
                                            <td>
                                            </td>
                                            <td>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>search
                                            </td>
                                            <td>検索を可能にするかどうか。
                                                <p>
                                                    true または false
                                            </td>
                                            <td>false
                                            </td>
                                            <td>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>editable
                                            </td>
                                            <td>
                                            </td>
                                            <td>編集できるかどうか true / false
                                                <p>
                                                    デフォルト値はtrue
                                            </td>
                                            <td>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>sortable
                                            </td>
                                            <td>並び替えを有効にするかどうか。
                                                <p>
                                                    並び替えの結果は”order” フィールドに1から順番に保存されます。
                                                <p>
                                                    true または false
                                            </td>
                                            <td>false
                                            </td>
                                            <td>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>download-csv
                                            </td>
                                            <td>データのCSVダウンロードを可能にするかどうか
                                                <p>
                                                    true または false
                                            </td>
                                            <td>false
                                            </td>
                                            <td>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>upload-csv
                                            </td>
                                            <td>データのCSVアップロードを可能にするかどうか（挿入のみ可能です）
                                                <p>
                                                    true または false
                                            </td>
                                            <td>false
                                            </td>
                                            <td>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>insert-last
                                            </td>
                                            <td>orderフィールドがある場合にのみ有効。
                                                <p>
                                                    新規に追加されたデータを最後に挿入する。
                                            </td>
                                            <td>false
                                            </td>
                                            <td>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>need-auth
                                            </td>
                                            <td>閲覧・編集のための権限が必要なテーブルかどうか
                                                <p>
                                                    true または false
                                                <p>
                                                    ※auth フィールドが管理者テーブル(ex. admin)に必要です。
                                            </td>
                                            <td>false
                                            </td>
                                            <td>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>1record
                                            </td>
                                            <td>１管理者１レコードのテーブルの場合、trueにする。
                                                <p>
                                                    例えばadminテーブル１レコードに対して、settingテーブル１レコードとなる場合等。
                                                <p>
                                                    その場合はsettingテーブルにadmin_idというフィールドを定義する。
                                            </td>
                                            <td>false
                                            </td>
                                            <td>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>show-menu</td>
                                            <td>メニューに表示するかどうか</td>
                                            <td>true</td>
                                            <td></td>
                                        </tr>
                                  </table>
                                  </div>
                                </div>
                                <div class="divider"></div>
                                <div class="content-items">
                                    <h2 id="高度な使い方" class="m-b-30">高度な使い方</h2>
                                    <h3 id="AmazonS3との連携">AmazonS3との連携</h3>
                                    <p>画像のアップロード時や、リッチテキストエディタからアップロードする画像・ファイルをS3にアップロードしたい場合の設定です。</p>
                                    <p>記載後、画像・ファイルは自動的にS3にアップロードされるようになります。</p>
                                </div>

                                <div class="content-items">
                                    <h3 id="PHPのフック" class="m-b-30">PHPのフック</h3>
                                    <p>追加・削除時などに別の処理を自身で記載したい場合、DocumentRootの直下にroutesディレクトリを作成し、その中に適当な名前のPHPを追加します。</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="clearfix"></div>
                </div>
            </div>
        </div>
        <!-- end page content -->
        
    </div>
    <!-- end page wrapper -->
    <footer class="footer-sect footer-tp">
        <div class="container">
            <div class="row">
                <div class="col-xs-12">
                    <ul class="footer-list">
                        <li><a href="faq.html">FAQ</a></li>
                        <li><a href="news.html">アップデート＆お知らせ</a></li>
                        <li><a href="terms.html">利用規約</a></li>
                        <li><a href="privacy.html">プライバシーポリシー</a></li>
                        <li><a href="#">会社概要 <i class="fa fa-window-restore"></i></a></li>
                    </ul>
                    <p>Copyright (c) All Rights Reserved.</p>
                </div>
            </div>
        </div>
    </footer>
    <!-- end footer -->
    <p><a href="#0" class="cd-top">Top</a></p>

    <script type="text/javascript" src="js/jquery-3.1.1.js"></script>
    <script type="text/javascript" src="js/bootstrap.min.js"></script>
    <script type="text/javascript" src="js/common.js"></script>
    <script type="text/javascript" src="js/slide-menu.js"></script>
    <script type="text/javascript" src="js/jquery.createTOC.js"></script>
    <script type="text/javascript" src="js/jquery.tocify.js"></script>
    <script defer>(function ($) {
        $(document).ready(function () {

            var menuLeft = $('#menu-left').slideMenu({
                position: 'left',
                submenuLinkAfter: ' >',
                backLinkBefore: '< '
            });

            if ($(window).width() > 767) {
                menuRight.open(false);
            }

        });
    })(jQuery);</script>

    <script type="text/javascript">
        $('.main').createTOC({
          insert: ".sidebar"
        });
    </script>

    <script>
        $(function() {

            var toc = $("#toc").tocify({
              selectors: "h2,h3,h4,h5"
            }).data("toc-tocify");

            prettyPrint();
            $(".optionName").popover({ trigger: "hover" });

        });
    </script>

</body>
</html>
