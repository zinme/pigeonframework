<!DOCTYPE html>
<html lang="ja">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Pigeon Framework</title>
        <link rel="shortcut icon" href="img/favicon.png">
        <link rel="stylesheet" href="css/font-awesome.min.css">
        <link rel="stylesheet" href="css/bootstrap.css">
        <link rel="stylesheet" href="https://cdn.rawgit.com/afeld/bootstrap-toc/v0.4.1/dist/bootstrap-toc.min.css">
        <link rel="stylesheet" href="css/style.css">
        <!-- google fonts -->
        <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet">
    </head>

<body data-spy="scroll" data-target="#toc">
    <div class="page-wrapper">
        <!-- header mobile-->
        <header class="header-mobile d-block d-lg-none">
            <div class="header-mobile__bar">
                <div class="container-fluid">
                    <div class="header-mobile-inner">
                        <a class="logo" href="index.html">Pigeon Framework</a>
                        <div class="header-hamburger"><a class="hamburger-menu hamburger-menu--normal" id="hamburger-btn"><span></span><span></span><span></span></a></div>
                    </div>
                </div>
            </div>
            <div class="nav-dropdown-menu" id="dropdown-menu">
              <nav>
                <ul>
                    <li class="dropdown-menu__item"><a class="dropdown-menu__link" href="index.html">TOP</a></li>
                    <li class="dropdown-menu__item"><a class="dropdown-menu__link" href="function.html">機能紹介</a></li>
                    <li class="dropdown-menu__item"><a class="dropdown-menu__link" href="project.html">事例</a></li>
                    <li class="dropdown-menu__item"><a class="dropdown-menu__link" href="plan.html">プラン</a></li>
                    <li class="dropdown-menu__item"><a class="dropdown-menu__link" href="support.html">サポート</a></li>
                </ul>
                <ul class="menu-list">
                    <li><a href="faq.html">FAQ</a></li>
                    <li><a href="news.html">アップデート＆お知らせ</a></li>
                    <li><a href="terms.html">利用規約</a></li>
                    <li><a href="privacy.html">プライバシーポリシー</a></li>
                </ul>
              </nav>
            </div>
            <div class="dropdown-overlay" id="dropdown-overlay"></div>
        </header>
        <!-- end header mobile-->

        <!-- menu sidebar toggle-->
        <aside class="menu-sidebar-toggle">

            <div class="hidden-xs hidden-sm">
                <div class="primary-nav">
                    <button href=# type="button" class="hamburger open-panel nav-toggle animated fadeInLeft is-closed" data-toggle="offcanvas">
                    <span class="hamb-top"></span>
                    <span class="hamb-middle"></span>
                    <span class="hamb-bottom"></span>
                    </button>
                  <nav role="navigation" class="menu">
                    <div class="overflow-container">
                      <ul class="sidebar-nav">
                           <li class="sidebar-brand">
                              <a class="logo" href="index.html">Pigeon Framework</a>
                           </li>
                           <li>
                              <a href="index.html">TOP</a>
                           </li>
                           <li>
                              <a href="function.html">機能紹介</a>
                           </li>
                           <li>
                              <a href="project.html">事例</a>
                           </li>
                           <li>
                              <a href="plan.html">プラン</a>
                           </li>
                           <li>
                              <a href="support.html">サポート</a>
                           </li>
                        </ul>
                    </div>
                  </nav>
                </div>
                 <div class="new-wrapper">
                    <nav id="toc" data-spy="affix" data-toggle="toc">
                    </nav>
                 </div> 
            </div>
            
            <!-- mobile menu toggle  -->
            <div class="hidden-lg hidden-md">
                <div role="main">
                    <div class="btn-list">
                        <button type="button" class="btn-icon slide-menu-control btn-open" data-target="menu-left" data-action="open"><img src="img/btn_list2x.png"></button>
                    </div>
                </div>
                <nav class="slide-menu" id="menu-left">
                  <div class="controls">
                    <button type="button" class="btn-icon slide-menu-control" data-action="close"><img src="img/btn_list@2x.png"></button>
                  </div>
                  <nav id="toc" data-spy="affix" data-toggle="toc"></nav>
                </nav>
            </div>
        </aside>
        <!-- end menu sidebar toggle-->

<!-- page content-->
<div class="page-content">
    <div class="container-fluid">
        <div class="inner-sect__p30">
            <div class="row">
                <div class="col-xs-12">
                    <span class="heading-top">ドキュメント</span>
                    <div class="divider"></div>
                    <h2>インストール方法</h2>
                    <h3 id="環境を確認する">環境を確認する</h3>
                    <p>
                    Linux(CentOS,Ubuntu,Amazon Linux)
                    </p>
                    <p>
                    PHP5.6以上
                    </p>
                    <p>
                    MySQL5.6以上
                    </p>
                    <p>
                    apache2.X
                    </p>
                    <p>
                    上記がインストールされていることを確認してください。
                    </p>
                    <h3 id="オプション環境">オプション環境</h3>

                    <p>
                    imagemagick (convertコマンドが使える場合、画像の自動リサイズが可能です。）
                    </p>
                    <p>
                    phpにて、下記関数が使える場合、スマートフォンからのアップロードで画像が回転している場合自動補正します。
                    </p>
                    <p>
                    ・exif_read_data()
                    </p>
                    <p>
                    ・ImageCreateFromJPEG()
                    </p>
                    <h3 id="基本構成">基本構成</h3>

                    <p>
                    DocumentRoot内にインストーラーが各種ファイルを配置します。
                    </p>
                    <p>
                    <strong>※DocumentRootの中は何も配置しないでください。すべて削除・上書きされます。</strong>
                    </p>
                    <h3 id="本体をインストールする">本体をインストールする</h3>

                    <pre class="prettyprint">cd ~/ wget https://pigeon-cms.loftal.jp/pigeon_installer && php pigeon_installer</pre>

                    <p>
                    ドキュメントルート、ドキュメントルートに外部からアクセスするためのURL、ライセンスキーが聞かれるので入力してください。
                    </p>
                    <p>
                    DB設定に応じて適切なデータベースやテーブルが作成されますので、現時点でアクセス可能なMySQLのアカウント情報を入力してください。
                    </p>
                    <p>
                    例えば、下記のような入力となります。
                    </p>
                    <p>
                    ※既存のテーブルに変更は行いませんが、管理者のテーブル(Admin table)及び画像保存用テーブル(image_blob)は新たに作成するため、存在しないテーブル名を指定してください。
                    </p>
                    <p>
                    (画像保存用テーブルのテーブル名変更はできません。）
                    </p>
                    <p>
                    トライアル用のライセンスキーはこちらから発行可能です。
                    </p>

<pre class="prettyprint">Please input DocumentRoot. (default. /var/www/html):/var/www/html
Please input URL to access DocumentRoot. (ex. http://example.com):http://example.com
Please input LICENSE KEY :{trial key}
Is production mode? (yes|no):no
Please input DATABASE hostname:localhost
Please input DATABASE user:root
Please input DATABASE password:password
Please input DATABASE name:test_db
Please input Admin table(default admin):admin</pre>

                    <p>
                    以下、DocumentRoot として /var/www/html/
                    </p>
                    <p>
                    URL: <a href="http://example.com">http://example.com</a> 
                    </p>
                    <p>
                    にインストールしたと仮定して説明します。
                    </p>
                    <h4 id="composer-にて関連モジュールをインストールする">composer にて関連モジュールをインストールする</h4>

                    <p>
                    もしcomposerにパスが通っていない場合、(composer.pharなどを直接使っている場合）下記のパスでcomposer install (php composer.phar install 等）を行ってください。
                    </p>

<pre class="prettyprint">cd {DocumentRoot}/Pigeon
composer install</pre>

                    <p>
                    データベースやライセンスキーの設定を書き換えたい場合は、こちらを参考にしてください。
                    </p>
                    <h4 id="apache等のウェブサーバーの設定">apache等のウェブサーバーの設定</h4>


                    <p>
                    上記で入力したhost名で、入力したdocumentRootを見るようにVirtualHost等の設定を行ってください。また、mod_rewriteを有効にしてください。
                    </p>
                    <p>
                    設定完了後、web serverを再起動してください。
                    </p>
                    <h3 id="管理画面にアクセスする">管理画面にアクセスする</h3>

                    <p>
                    管理画面URL（<a href="http://example.com/adminの場合は、">http://example.com</a>/{管理者テーブル名}/login ）にアクセスします。
                    </p>
                    <p>
                    {prefix}admin が管理者テーブルとなります。
                    </p>
                    <p>
                    （prefixがpigeon_の場合,管理者テーブルはpigeon_adminとなります。）
                    </p>
                    <p>
                    管理者テーブル名がpigeon_adminの場合、ログイン画面は
                    </p>
                    <p>
                    <a href="http://example.com/adminの場合は、">http://example.com/</a>pigeon_admin/loginとなります。
                    </p>
                    <p>
                    ログイン画面が開き、ID,パスワードを要求されます。
                    </p>
                    <p>
                    admin / admin
                    </p>
                    <p>
                    を入力してください。
                    </p>
                    <h3 id="【重要】セキュリティ確認">【重要】セキュリティ確認</h3>

                    <p>
                    <a href="http://example.com/config/config.yml">http://example.com/config/config.yml</a>
                    </p>
                    <p>
                    にアクセスし、必ず表示が<strong>されない</strong>ことを確認してください。
                    </p>
                    <p>
                    表示されてしまう場合、.htaccessが正しく動いているか等、apacheの設定を確認してください。
                    </p>
                    <h2 id="メニューの設定">メニューの設定</h2>

                    <h3 id="管理するテーブルを設定する。">管理するテーブルを設定する。</h3>

                    <p>
                    /var/www/html/config/config.yml
                    </p>
                    <p>
                    ファイルを修正します。
                    </p>
                    <p>
                    login-tables => {管理者テーブル名} => menusの中に、管理者テーブルのテーブル名をキーとした配列を作成します。
                    </p>

<pre class="prettyprint">login-tables:
 admin:
   label: "管理者"
   menus:
     - table: contents
       label: "コンテンツ"
       fields:
         - field: title
           label: "文字列"
           type: text
           default: デフォルト値
         - field: textarea
           label: "テキストエリア"
           type: textarea
         - field: rich_body</pre>


                    <h3 id="基本のhash定義">基本のhash定義</h3>

                    <p>
                    rootのkeyは、ユーザーのテーブルとなります。上の例ではadminテーブルのユーザーがログインした時という指定になっています。
                    </p>

                    <table>
                      <tr>
                       <td>
                       </td>
                       <td><strong>説明</strong>
                       </td>
                       <td><strong>Default</strong>
                       </td>
                       <td><strong>必須</strong>
                       </td>
                      </tr>
                      <tr>
                       <td>title
                       </td>
                       <td>管理画面ログイン後の左上に表示する文字列
                       </td>
                       <td>管理システム
                       </td>
                       <td>
                       </td>
                      </tr>
                      <tr>
                       <td>label
                       </td>
                       <td>管理者テーブル名（管理者、ユーザー等）
                       </td>
                       <td>
                       </td>
                       <td>o
                       </td>
                      </tr>
                      <tr>
                       <td>disable-setting
                       </td>
                       <td>右上のドロップダウンメニューで、自分自身の設定を非表示にするかどうか
                       </td>
                       <td>false
                       </td>
                       <td>
                       </td>
                      </tr>
                    </table>

                    <h3 id="テーブル名のリストの中のhash定義">テーブル名のリストの中のhash定義</h3>

                    <p>
                    menusの直下に下の表のhashのlistを作成します。
                    </p>
                    <p>
                    hashは以下の定義が可能です。
                    </p>
                    <p>
                    全て必須ではありません。
                    </p>

                    <table>
                      <tr>
                       <td>
                       </td>
                       <td><strong>説明</strong>
                       </td>
                       <td><strong>Default</strong>
                       </td>
                       <td width="10%"><strong>必須</strong>
                       </td>
                      </tr>
                      <tr>
                       <td>table
                       </td>
                       <td>テーブル名
                       </td>
                       <td>
                       </td>
                       <td>
                       </td>
                      </tr>
                      <tr>
                       <td>fields
                       </td>
                       <td>テーブルで編集・表示するフィールドを管理します。特に記載がない場合は、データベースのテーブル定義から自動的に作成します。詳細は下部の「fieldsのhashの定義」を確認してください。
                       </td>
                       <td>テーブル定義から
                       </td>
                       <td>
                       </td>
                      </tr>
                      <tr>
                       <td>paren-id-field
                       </td>
                       <td>child-table 内のテーブルの場合必須。
                    <p>
                    親のテーブルのIDを表すfield名を指定
                    <p>
                    例（parent_id)
                       </td>
                       <td>
                       </td>
                       <td>△
                       </td>
                      </tr>
                      <tr>
                       <td>label
                       </td>
                       <td>メニューに表示されるラベル
                       </td>
                       <td>
                       </td>
                       <td>
                       </td>
                      </tr>
                      <tr>
                       <td>icon
                       </td>
                       <td>メニューに表示されるアイコン（font-awesomeのクラス名）
                       </td>
                       <td>th-list
                       </td>
                       <td>
                       </td>
                      </tr>
                      <tr>
                       <td>child-table
                       </td>
                       <td>１：多のテーブルがある場合に定義する。例えば、ユーザー１人に対して持っているアイテムが複数ある場合等。
                    <p>
                    値として定義するhashはtableやfieldsなど、テーブル名のリストのハッシュと同じですが、child-tableの下に更にchild-tableを定義することはできません。
                       </td>
                       <td>
                       </td>
                       <td>
                       </td>
                      </tr>
                      <tr>
                       <td>parent-id-field
                       </td>
                       <td>child-table の中にあるhashでのみ適用可能。親のIDのフィールドをセットします。
                       </td>
                       <td>{親テーブル名}_id
                       </td>
                       <td>
                       </td>
                      </tr>
                      <tr>
                       <td>url
                       </td>
                       <td>ページにリンクしたい場合、リンク先のURLを設定します。
                       </td>
                       <td>
                       </td>
                       <td>
                       </td>
                      </tr>
                      <tr>
                       <td>search
                       </td>
                       <td>検索を可能にするかどうか。
                    <p>
                    true または false
                       </td>
                       <td>false
                       </td>
                       <td>
                       </td>
                      </tr>
                      <tr>
                       <td>editable
                       </td>
                       <td>
                       </td>
                       <td>編集できるかどうか true / false
                    <p>
                    デフォルト値はtrue
                       </td>
                       <td>
                       </td>
                      </tr>
                      <tr>
                       <td>sortable
                       </td>
                       <td>並び替えを有効にするかどうか。
                    <p>
                    並び替えの結果は”order” フィールドに1から順番に保存されます。
                    <p>
                    true または false
                       </td>
                       <td>false
                       </td>
                       <td>
                       </td>
                      </tr>
                      <tr>
                       <td>download-csv
                       </td>
                       <td>データのCSVダウンロードを可能にするかどうか
                    <p>
                    true または false
                       </td>
                       <td>false
                       </td>
                       <td>
                       </td>
                      </tr>
                      <tr>
                       <td>upload-csv
                       </td>
                       <td>データのCSVアップロードを可能にするかどうか（挿入のみ可能です）
                    <p>
                    true または false
                       </td>
                       <td>false
                       </td>
                       <td>
                       </td>
                      </tr>
                      <tr>
                       <td>insert-last
                       </td>
                       <td>orderフィールドがある場合にのみ有効。
                    <p>
                    新規に追加されたデータを最後に挿入する。
                       </td>
                       <td>false
                       </td>
                       <td>
                       </td>
                      </tr>
                      <tr>
                       <td>need-auth
                       </td>
                       <td>閲覧・編集のための権限が必要なテーブルかどうか
                    <p>
                    true または false
                    <p>
                    ※auth フィールドが管理者テーブル(ex. admin)に必要です。
                       </td>
                       <td>false
                       </td>
                       <td>
                       </td>
                      </tr>
                      <tr>
                       <td>1record
                       </td>
                       <td>１管理者１レコードのテーブルの場合、trueにする。
                    <p>
                    例えばadminテーブル１レコードに対して、settingテーブル１レコードとなる場合等。
                    <p>
                    その場合はsettingテーブルにadmin_idというフィールドを定義する。
                       </td>
                       <td>false
                       </td>
                       <td>
                       </td>
                      </tr>
                      <tr>
                       <td>show-menu
                       </td>
                       <td>メニューに表示するかどうか
                       </td>
                       <td>true
                       </td>
                       <td>
                       </td>
                      </tr>
                    </table>

                    <h4 id="fieldsのhashの定義">fieldsのhashの定義</h4>

                    <p>
                    フィールドからフォームを作成する設定は設定ファイルからでもテーブル定義から自動的に読み込むことも可能です。
                    </p>
                    <p>
                    設定ファイルに記載した設定が優先して読み込まれます。
                    </p>

                    <table>
                      <tr>
                       <td>
                       </td>
                       <td width="10%"><strong>必須</strong>
                       </td>
                       <td><strong>説明</strong>
                       </td>
                       <td width="30%"><strong>テーブルで定義する場合(Default)</strong>
                       </td>
                      </tr>
                      <tr>
                       <td>field
                       </td>
                       <td>
                       </td>
                       <td>テーブルのフィールド名
                       </td>
                       <td>
                       </td>
                      </tr>
                      <tr>
                       <td>label
                       </td>
                       <td>
                       </td>
                       <td>項目名
                       </td>
                       <td>COMMENTに記載
                       </td>
                      </tr>
                      <tr>
                       <td>type
                       </td>
                       <td>
                       </td>
                       <td>数値型や文字列型、日付型などの定義を行います。この定義によって編集画面のフォームが変化します。
                    <p>
                    TYPEはTYPE一覧から選択してください。
                       </td>
                       <td>TYPEから自動判断
                       </td>
                      </tr>
                      <tr>
                       <td>required
                       </td>
                       <td>
                       </td>
                       <td>true / false 
                    <p>
                    デフォルトはfalse
                       </td>
                       <td>Allow Nullの定義に従う
                       </td>
                      </tr>
                      <tr>
                       <td>value
                       </td>
                       <td>
                       </td>
                       <td>固定値を指定したい場合。（編集不可となります。）
                    <p>
                    また、以下の変数を使用可能です。
                    <p>
                    {parent_data}親のデータ
                       </td>
                       <td>
                       </td>
                      </tr>
                      <tr>
                       <td>max-length
                       </td>
                       <td>
                       </td>
                       <td>※ text、textarea、rich_text のみ有効
                    <p>
                    長さの最大値の定義をします。
                       </td>
                       <td>フィールド定義の長さから自動判断
                       </td>
                      </tr>
                      <tr>
                       <td>min-length
                       </td>
                       <td>
                       </td>
                       <td>※ text、textarea、rich_text のみ有効
                    <p>
                    長さの最小値の定義をします。
                       </td>
                       <td>0
                       </td>
                      </tr>
                      <tr>
                       <td>visible
                       </td>
                       <td>
                       </td>
                       <td>true または false
                       </td>
                       <td>COMMENTに値があれば自動的に表示される。
                       </td>
                      </tr>
                      <tr>
                       <td>default
                       </td>
                       <td>
                       </td>
                       <td>デフォルト値
                       </td>
                       <td>デフォルト値
                       </td>
                      </tr>
                      <tr>
                       <td>items
                       </td>
                       <td>
                       </td>
                       <td>typeがradio,select,checkboxの場合に選択するアイテムを定義する
                    <p>
                    例:
                    <p>
                    label: かっこいい
                    <p>
                    value: cool
                       </td>
                       <td>TYPE一覧参照
                       </td>
                      </tr>
                      <tr>
                       <td>image-width
                       </td>
                       <td>
                       </td>
                       <td>typeがimageの場合に、最大の幅を設定する。最大の幅を超えている場合、自動的にリサイズする。
                    <p>
                    (/usr/local/bin/convert のコマンドが存在する場合のみ有効)
                       </td>
                       <td>
                       </td>
                      </tr>
                      <tr>
                       <td>image-height
                       </td>
                       <td>
                       </td>
                       <td>typeがimageの場合に、最大の高さを設定する。最大の高さを超えている場合、自動的にリサイズする。
                    <p>
                    (/usr/local/bin/convert のコマンドが存在する場合のみ有効)
                       </td>
                       <td>
                       </td>
                      </tr>
                      <tr>
                       <td>boolean-text
                       </td>
                       <td>
                       </td>
                       <td>typeがbooleanの場合のチェックボックスの右に表示するテキスト
                       </td>
                       <td>
                       </td>
                      </tr>
                      <tr>
                       <td>thumbnail-field
                       </td>
                       <td>
                       </td>
                       <td>typeがimageの時のみ有効。サムネイルを保存するフィールドを指定。保存先のフィールドはtext型で、同じテーブル上にある必要があります。
                        <p>また、保存したサムネイルは一覧画面で使用さ...
                        </td>
                        <td></td>
                        </tr>
                    </table>
                    <h2 id="高度な使い方">高度な使い方</h2>
                    <h3 id="AmazonS3との連携">AmazonS3との連携</h3>
                    <p>画像のアップロード時や、リッチテキストエディタからアップロードする画像・ファイルをS3にアップロードしたい場合の設定です。</p>
                    <p>記載後、画像・ファイルは自動的にS3にアップロードされるようになります。</p>
                    <h3 id="PHPのフック">PHPのフック</h3>
                    <p>追加・削除時などに別の処理を自身で記載したい場合、DocumentRootの直下にroutesディレクトリを作成し、その中に適当な名前のPHPを追加します。</p>
                </div>
            </div>
            <div class="clearfix"></div>
        </div>
    </div>
</div>
<!-- end page content -->
        
    </div>
    <!-- end page wrapper -->
    <footer class="footer-sect footer-tp">
        <div class="container">
            <div class="row">
                <div class="col-xs-12">
                    <ul class="footer-list">
                        <li><a href="faq.html">FAQ</a></li>
                        <li><a href="news.html">アップデート＆お知らせ</a></li>
                        <li><a href="terms.html">利用規約</a></li>
                        <li><a href="privacy.html">プライバシーポリシー</a></li>
                        <li><a href="#">会社概要 <i class="fa fa-window-restore"></i></a></li>
                    </ul>
                    <p>Copyright (c) All Rights Reserved.</p>
                </div>
            </div>
        </div>
    </footer>
    <!-- end footer -->
    <p><a href="#0" class="cd-top">Top</a></p>

    <script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
    <script type="text/javascript" src="js/bootstrap.min.js"></script>
    <script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v0.4.1/dist/bootstrap-toc.min.js"></script>
    <script type="text/javascript" src="js/common.js"></script>
    <script type="text/javascript" src="js/slide-menu.js"></script>

    <script defer>(function ($) {
        $(document).ready(function () {

            var menuLeft = $('#menu-left').slideMenu({
                position: 'left',
                submenuLinkAfter: ' >',
                backLinkBefore: '< '
            });

            if ($(window).width() > 767) {
                menuRight.open(false);
            }

        });
    })(jQuery);</script>

    <script type="text/javascript">
        $(function() {
          var navSelector = 'h2,h3,h4';
          var $myNav = $(navSelector);
          Toc.init($myNav);
          $('body').scrollspy({
            target: navSelector
          });
        });
    </script>

</body>
</html>
